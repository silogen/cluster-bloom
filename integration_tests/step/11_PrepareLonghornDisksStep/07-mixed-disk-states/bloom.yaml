ENABLED_STEPS: PrepareLonghornDisksStep
CLUSTER_DISKS: /dev/sda,/dev/sdb

mocks:
  PrepareLonghornDisksStep.ReadFstab:
    output: ""
  PrepareLonghornDisksStep.ListMounts:
    output: ""
    args: ["sh", "-c", "mount | awk '/\\/mnt\\/disk[0-9]+/ {print $3}'"]
  PrepareLonghornDisksStep.CheckFilesystem./dev/sda:
    output: "NAME FSTYPE\nsda  ext4"
    args: ["lsblk", "-f", "/dev/sda"]
  PrepareLonghornDisksStep.GetUUID./dev/sda:
    output: "aaa-111"
    args: ["blkid", "-s", "UUID", "-o", "value", "/dev/sda"]
  PrepareLonghornDisksStep.CreateMountPoint./mnt/disk0:
    output: ""
    args: ["mkdir", "-p", "/mnt/disk0"]
  PrepareLonghornDisksStep.MountDrive./dev/sda:
    output: ""
    args: ["mount", "/dev/sda", "/mnt/disk0"]
  PrepareLonghornDisksStep.CheckFilesystem./dev/sdb:
    output: "NAME FSTYPE\nsdb  "
    args: ["lsblk", "-f", "/dev/sdb"]
  PrepareLonghornDisksStep.CheckPartitionType./dev/sdb:
    output: ""
    args: ["lsblk", "-no", "PARTTYPE", "/dev/sdb"]
  PrepareLonghornDisksStep.FormatDisk./dev/sdb:
    output: ""
    args: ["mkfs.ext4", "-F", "-F", "/dev/sdb"]
  PrepareLonghornDisksStep.GetUUID./dev/sdb:
    output: "bbb-222"
    args: ["blkid", "-s", "UUID", "-o", "value", "/dev/sdb"]
  PrepareLonghornDisksStep.CreateMountPoint./mnt/disk1:
    output: ""
    args: ["mkdir", "-p", "/mnt/disk1"]
  PrepareLonghornDisksStep.MountDrive./dev/sdb:
    output: ""
    args: ["mount", "/dev/sdb", "/mnt/disk1"]
  PersistMountedDisks.BackupFstab:
    output: ""
    args: ["sudo", "cp", "/etc/fstab", "/etc/fstab.bak"]
  PersistMountedDisks.GetUUID./dev/sda-aaa-111:
    output: "aaa-111"
    args: ["blkid", "-s", "UUID", "-o", "value", "/dev/sda"]
  PersistMountedDisks.AddFstabEntry./mnt/disk0:
    output: ""
    args: ["sh", "-c", "echo 'UUID=aaa-111 /mnt/disk0 ext4 defaults,nofail 0 2 # managed by cluster-bloom' | sudo tee -a /etc/fstab"]
  PersistMountedDisks.GetUUID./dev/sdb-bbb-222:
    output: "bbb-222"
    args: ["blkid", "-s", "UUID", "-o", "value", "/dev/sdb"]
  PersistMountedDisks.AddFstabEntry./mnt/disk1:
    output: ""
    args: ["sh", "-c", "echo 'UUID=bbb-222 /mnt/disk1 ext4 defaults,nofail 0 2 # managed by cluster-bloom' | sudo tee -a /etc/fstab"]
  PersistMountedDisks.RemountAll:
    output: ""
    args: ["sudo", "mount", "-a"]
